cfp_headgear_armor = {

	usage = game
	selection_behavior = weighted_random
	priority = 4
	
	cfp_western_war_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_western_war_high_nobility
				range = { 0 1 }
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				is_male = yes # because there's no women versions
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = western 
				}
                portrait_high_nobles_armor_trigger = {
                    CULTURE_INPUT = dde_hre
                }
			}
		}
	}
	
	cfp_western_era3_war_nobility = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_western_era3_war_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = western 
				}
				NOT = { has_game_rule = never_cfp_fullplate_helmets }
				portrait_era3_armor_trigger = yes
			}
		}
	}
	
	cfp_western_era4_war_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_western_era3_war_nobility
				range = { 0.37 1 } # Kettle hats
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = western 
				}
                portrait_commoner_armor_trigger = { 
                    CULTURE_INPUT = western
                }
				portrait_era4_armor_trigger = yes
			}
		}
	}
	
	cfp_western_war_plate_armor = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_western_war_plate_armor
				range = { 0.27 1.0 }
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				is_male = yes # because there's no women versions
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = western 
				}
				cfp_innovation_plate_armor_trigger = yes
			}
		}
	}
	
	cfp_western_war_plate_armor_fullplate = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_western_war_plate_armor
				range = { 0 0.26 }
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				is_male = yes # because there's no women versions
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = western 
				}
				cfp_innovation_plate_armor_trigger = yes
				NOT = { has_game_rule = never_cfp_fullplate_helmets }
			}
		}
	}

## Latin

	cfp_latin_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_latin_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_latin
				}
			}
		}
	}

## Iberian

	cfp_iberian_war_aragonese_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_iberian_war_aragonese_royalty
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 101
				exists = this
				portrait_wear_helmet_trigger = yes
				portrait_era4_armor_trigger = yes
				NOT = { has_game_rule = never_cfp_fullplate_helmets }
				portrait_religious_christian_trigger = yes
				OR = {
					AND = {
						exists = this
						has_primary_title = title:k_aragon
					}
					AND = {
						exists = primary_title
						has_primary_title = title:e_spain
						has_title = title:k_aragon
					}
				}
			}
		}
	}

	cfp_iberian_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_iberian_war
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_iberian_christian
				}
			}
		}
	}

## Hungarian

	cfp_hungarian_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_hungarian_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_hungarian
				}
			}
		}
	}

## Slavic

	cfp_slavic_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_slavic_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_slavic
				}
			}
		}
	}

## MENA ##

    cfp_mena_war_commoners = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = cfp_mena_war
                range = { 0 1 }
            }
        }
        outfit_tags = { military_outfit }
        weight = {
            base = 0
            modifier = {
                add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = mena 
				}
                portrait_commoner_armor_trigger = { 
                    CULTURE_INPUT = mena
                }
            }
        }
    }
	
	cfp_mena_war_high_medieval = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_mena_war_high_medieval
				range = { 0 1 }
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = mena 
				}
				OR = {
					portrait_era3_armor_trigger = yes
					portrait_era4_armor_trigger = yes
				}
			}
		}
	}

	cfp_mena_war_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_mena_war_high_nobility
				range = { 0 1 }
			}
		}
        outfit_tags = { military_outfit }
        weight = {
            base = 0
            modifier = {
                add = 50 
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = mena
                }
                portrait_high_nobles_armor_trigger = {
                    CULTURE_INPUT = mena
                }
            }
        }
	}

## Andalusian

	cfp_andalusian_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_andalusian_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_iberian_muslim
				}
			}
		}
	}
	
	cfp_andalusian_war_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_andalusian_war
				accessory = male_headgear_secular_andalusian_cfp_war_sallet_01
			}
		}
        outfit_tags = { military_outfit }
        weight = {
            base = 0
            modifier = {
                add = 50
				portrait_era4_armor_trigger = yes
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_iberian_muslim
                }
                portrait_high_nobles_armor_trigger = {
                    CULTURE_INPUT = cfp_iberian_muslim
                }
            }
        }
	}

## Iranian

	cfp_iranian_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_iranian_war
				range = { 0 1 }
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_iranian 
				}
			}
		}
	}
	
	cfp_iranian_war_high_medieval = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_iranian_war_high_medieval
				range = { 0 1 } # For the randomness to work correctly
			}
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_iranian 
				}
				OR = {
					portrait_era3_armor_trigger = yes
					portrait_era4_armor_trigger = yes
				}
			}
		}
	}

## Turkic

	cfp_turkic_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_turkic_war
				range = { 0.51 1.0 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 101
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_turkic
                }
			}
		}
	}

	cfp_turkic_war_fullplate = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_turkic_war
				range = { 0 0.49 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
                add = 101
				NOT = { has_game_rule = never_cfp_fullplate_helmets }
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_turkic
                }
            }
		}
	}

## Northern Pagans

	cfp_norse_war_common = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_norse_war
				range = { 0 0.74 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60 # slightly higher than northern
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_norse
                }
			}
		}
	}

	cfp_norse_war_fancy = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_norse_war
				range = { 0.76 1.0 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60 # slightly higher than northern
				portrait_war_nobles_fancy_helmet_trigger = yes
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_norse
                }
			}
		}
	}

## Norman

	cfp_norman_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = northern_war
				range = { 0 0.84 } # let's avoid coppergate helmet
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 101
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_norman
                }
				portrait_era2_armor_trigger = yes
                has_ep2_dlc_trigger = yes # to match cfp_norman_war clothing rule
			}
		}
	}
	
	cfp_norman_sicily_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_norman_sicily_war
				range = { 0 1 }
			}
            morph = {
                mode = add
                gene = gene_bs_nose_forward
                template = nose_forward_neg                
                value = 1.0
            }
		}
        outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 102 # slightly higher than cfp_norman_war
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = cfp_norman_sicily 
				}
				NOT = { has_game_rule = never_cfp_fullplate_helmets }
			}
		}
	}

## African

	cfp_west_african_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_west_african_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_west_africa
                }
			}
		}
	}

	cfp_east_african_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_east_african_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_east_africa
                }
			}
		}
	}

	cfp_central_african_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = cfp_central_african_war
				range = { 0 1 }
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = cfp_central_africa
                }
			}
		}
	}

}
